#- name: create opt directory for prometheus
 # file:
  #  path: /backend
 #   state: 

- name: Creates Directory
  become: yes
  file:
    path: ~/backend
    state: directory
    mode: 0755

- name: Extract artifact.tar.gz
  become: true
  ansible.builtin.unarchive:
    src: ~/project/artifact.tar.gz
    dest: /home/ubuntu
    

#- name: Install packages
 # become: true
 # npm:
 #   path: ~/backend
   

- name: Executing node
  become: true
  become_user: root
  shell: |
    cd /home/ubuntu/backend
    npm install


- name: start server
  become: true
  become_user: root
  shell: |
      
    cd /home/ubuntu/backend
    pm2 stop default
    pm2 start main.js
   